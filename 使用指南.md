# 医学考试系统 - 完整使用指南

## 🎯 系统概述

本系统由**后台管理系统**和**前台考试系统**组成，通过localStorage实现数据共享，提供完整的题库管理和智能考试功能。

## 📋 系统文件结构

```
医学考试系统/
├── admin.html          # 后台管理系统
├── exam.html           # 前台考试系统  
├── README.md           # 使用说明
└── data/
    └── 题库样例.xlsx   # Excel题库文件
```

## 🚀 完整使用流程

### 第一步：部署系统文件

1. **创建项目文件夹**
2. **保存系统文件**：
   - 将后台管理系统保存为 `admin.html`
   - 将前台考试系统保存为 `exam.html`
3. **准备题库文件**：Excel格式题库

### 第二步：配置后台管理系统

1. **打开后台管理**：
   ```
   在浏览器中打开 admin.html
   ```

2. **配置API服务**：
   - 点击"⚙️ API配置"标签
   - 选择API服务商（OpenAI/通义千问/智谱AI）
   - 输入API Key
   - 点击"保存配置"和"测试连接"

3. **导入题库**：
   - 点击"📤 批量导入"标签
   - 拖拽或选择Excel文件上传
   - 等待导入完成，查看导入结果

### 第三步：管理题库内容

**在后台管理系统中：**

1. **查看数据概览**：
   - 题库总数统计
   - 题型分布
   - 知识分类统计

2. **题库管理**：
   - 添加新题目
   - 编辑现有题目
   - 删除不需要的题目
   - 搜索特定题目

3. **数据维护**：
   - 导出题库备份
   - 查看导入历史
   - 统计分析

### 第四步：前台考试系统

1. **打开考试系统**：
   ```
   在浏览器中打开 exam.html
   ```

2. **开始考试**：
   - 系统自动加载后台配置的API
   - 点击"开始考试"
   - 系统随机从题库选择10道题

3. **答题过程**：
   - 逐题答题，即时反馈
   - 显示答题进度
   - 自动记录答题详情

4. **查看结果**：
   - 考试完成后查看分数
   - AI生成个性化学习报告
   - 查看详细的错题分析

## 🔄 数据流转机制

### 数据共享方式
```
后台管理系统 ←→ localStorage ←→ 前台考试系统
```

### 共享的数据内容
- **questionBank**: 题库数据
- **apiConfig**: API配置信息
- **examRecords**: 考试记录
- **importHistory**: 导入历史

### 数据同步说明
- 后台添加/编辑题目 → 前台立即可用
- 后台配置API → 前台自动应用
- 前台考试记录 → 可在后台查看统计

## 📊 Excel题库格式要求

### 支持的格式
```
列A: 题目类别    (如：疾病、药物、治疗)
列B: 题目类型    (单选题/多选题)
列C: 题目内容    (完整的题目描述)
列D: 正确答案    (单选：A，多选：ABC)
列E: 选项A      (第一个选项内容)
列F: 选项B      (第二个选项内容)
列G: 选项C      (第三个选项内容)
列H: 选项D      (第四个选项内容)
```

### 导入规则
- 第一行为标题行，自动跳过
- 支持单选题和多选题
- 空行自动忽略
- 建议一次导入不超过500题

## ⚙️ API配置说明

### 支持的AI服务

**OpenAI**
- API地址：`https://api.openai.com/v1/chat/completions`
- 模型：`gpt-3.5-turbo` 或 `gpt-4`
- 获取方式：OpenAI官网注册

**通义千问**
- API地址：`https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation`
- 模型：`qwen-turbo` 或 `qwen-plus`
- 获取方式：阿里云控制台

**智谱AI**
- API地址：`https://open.bigmodel.cn/api/paas/v4/chat/completions`
- 模型：`glm-4`
- 获取方式：智谱AI官网

### API配置步骤
1. 选择API服务商
2. 输入对应的API Key
3. 系统自动填充API地址和模型
4. 测试连接确保配置正确

## 🔧 系统特性

### 后台管理特性
- ✅ 可视化数据统计
- ✅ Excel批量导入
- ✅ 题目CRUD操作
- ✅ API统一配置
- ✅ 导入历史记录
- ✅ 数据导出备份

### 前台考试特性
- ✅ 随机抽题机制
- ✅ 智能答案验证
- ✅ 实时进度显示
- ✅ AI评估报告
- ✅ 移动端适配
- ✅ 考试记录保存

### 数据安全特性
- ✅ 本地存储，数据私密
- ✅ 自动备份机制
- ✅ 错误恢复能力
- ✅ 跨浏览器兼容

## 📱 移动端使用

### 响应式设计
- 完美适配手机屏幕
- 触摸友好的交互
- 流畅的答题体验

### 移动端优化
- 简化的操作流程
- 清晰的进度指示
- 优化的加载速度

## 🚨 故障排除

### 常见问题

**1. 题库为空**
- 检查是否已导入Excel文件
- 确认Excel格式正确
- 查看导入历史记录

**2. API调用失败**
- 检查API Key是否正确
- 确认网络连接正常
- 验证API服务商设置

**3. 考试无法开始**
- 确认题库不为空
- 检查API配置
- 清除浏览器缓存重试

**4. 数据丢失**
- 检查localStorage是否被清除
- 重新导入题库备份
- 确认浏览器兼容性

### 数据备份建议
- 定期导出题库数据
- 保存API配置信息
- 备份重要考试记录

## 🔮 扩展功能建议

### 可扩展功能
- 多用户管理
- 考试时间限制
- 题目难度分级
- 学习进度跟踪
- 错题本功能
- 成绩对比分析

### 技术扩展
- 数据库存储
- 云端同步
- 实时协作
- 移动应用
- 微信小程序

## 📞 技术支持

### 系统要求
- 现代浏览器（Chrome/Firefox/Safari/Edge）
- JavaScript支持
- localStorage支持
- 网络连接（用于AI功能）

### 兼容性
- PC端：Windows/Mac/Linux
- 移动端：iOS/Android
- 浏览器版本：近3年版本

---

## 🎉 开始使用

1. **保存系统文件** → admin.html 和 exam.html
2. **配置API服务** → 后台管理系统
3. **导入题库** → 上传Excel文件
4. **开始考试** → 前台考试系统

系统已经完全集成，现在可以享受完整的智能考试体验！